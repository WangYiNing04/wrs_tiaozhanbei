# 固定眼相机标定说明

## 概述

本目录包含了固定眼相机（Eye-to-hand）的手动标定方法，与手眼相机（Eye-in-hand）标定不同，固定眼相机是固定在世界坐标系中的，用于观察机器人工作区域。

## 文件说明

### 1. `manual_calib_piper_fixed_eye_camera.py`
单固定眼相机标定程序

**特点：**
- 支持单个固定相机的标定
- 相机固定在世界坐标系中
- 标定矩阵表示相机到世界坐标系的变换

**使用方法：**
```bash
python manual_calib_piper_fixed_eye_camera.py
```

**操作说明：**
- W/S: 相机X轴移动
- A/D: 相机Y轴移动
- Q/E: 相机Z轴移动
- Z/X: 绕X轴旋转
- C/V: 绕Y轴旋转
- B/N: 绕Z轴旋转

### 2. `manual_calib_piper_multiple_fixed_eye_cameras.py`
多固定眼相机标定程序

**特点：**
- 支持同时标定多个固定相机
- 可以切换当前标定的相机
- 不同相机用不同颜色显示点云
- 支持保存和加载多相机标定结果

**使用方法：**
```bash
python manual_calib_piper_multiple_fixed_eye_cameras.py
```

**操作说明：**
- T: 切换当前标定的相机
- W/S: 当前相机X轴移动
- A/D: 当前相机Y轴移动
- Q/E: 当前相机Z轴移动
- Z/X: 当前相机绕X轴旋转
- C/V: 当前相机绕Y轴旋转
- B/N: 当前相机绕Z轴旋转

## 标定原理

### 手眼相机 vs 固定眼相机

| 类型 | 相机位置 | 标定矩阵含义 | 变换链 |
|------|----------|--------------|--------|
| 手眼相机 | 安装在机器人末端 | 机器人末端到相机的变换 | 世界→机器人→相机→点云 |
| 固定眼相机 | 固定在世界坐标系中 | 相机到世界坐标系的变换 | 相机→世界→点云 |

### 固定眼相机标定矩阵

固定眼相机的标定矩阵 `T_cam2world` 直接将相机坐标系中的点云变换到世界坐标系：

```
P_world = T_cam2world * P_camera
```

其中：
- `P_camera`: 相机坐标系中的点云
- `P_world`: 世界坐标系中的点云
- `T_cam2world`: 4x4齐次变换矩阵

## 标定步骤

1. **准备环境**
   - 确保相机和机器人连接正常
   - 在工作区域放置标定板或特征物体

2. **运行标定程序**
   - 选择合适的标定程序（单相机或多相机）
   - 程序会自动加载初始标定矩阵

3. **手动调整**
   - 使用键盘控制调整相机位置和姿态
   - 观察点云与机器人模型的对齐情况
   - 实时查看标定效果

4. **保存结果**
   - 标定完成后程序会自动保存结果
   - 标定文件格式为JSON

## 标定文件格式

### 单相机标定文件
```json
{
    "affine_mat": [
        [1.0, 0.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 1.0, 1.0],
        [0.0, 0.0, 0.0, 1.0]
    ]
}
```

### 多相机标定文件
```json
{
    "camera_calibrations": [
        {
            "camera_id": 0,
            "affine_mat": [...]
        },
        {
            "camera_id": 1,
            "affine_mat": [...]
        }
    ]
}
```

## 注意事项

1. **相机位置**：确保相机能够完整观察机器人工作区域
2. **标定精度**：使用高对比度的标定板或特征物体
3. **光照条件**：保持稳定的光照条件
4. **多相机标定**：确保多个相机之间有足够的重叠区域
5. **实时保存**：标定过程中会实时保存，避免数据丢失

## 故障排除

1. **相机连接问题**：检查相机ID和连接状态
2. **机器人连接问题**：确保机器人控制器正常工作
3. **标定精度差**：调整相机位置和姿态，使用更好的标定目标
4. **程序崩溃**：检查依赖库是否正确安装

## 扩展功能

可以根据需要扩展以下功能：
- 自动标定算法
- 标定精度评估
- 多相机标定优化
- 标定结果可视化



